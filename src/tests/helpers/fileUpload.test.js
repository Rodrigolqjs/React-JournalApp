import 'setimmediate';
import cloudinary from "cloudinary";
import { fileUpload } from "../../helpers/fileUpload";



cloudinary.config({ 
    cloud_name: 'dpbp1t0qw', 
    api_key: '788425142315191', 
    api_secret: 'e1kD7r5Me2nffgxUOTDjuYzJO8c',
    secure: true
  });



describe('Pruebas en fileUpload', () => {
    
    test('debe de cargar un archivo y retornar el URL', async() => {

        const resp = await fetch('data:image/png;base64,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');
        const blob = await resp.blob();

        const file = new File([blob], 'foto.png')
        const url = await fileUpload( file );
        // console.log(url);

        // expect( typeof url).toBe('string')

        //borrar img por id
        const segments = url.split('/')
        const imgId = segments[segments.length - 1 ].replace('.png', '')

        // console.log(imgId);
        await cloudinary.v2.api.delete_resources( imgId, {}, () => {
            // console.log('img borrada');
        });


    })

    test('debe de retornar un error', async() => {


        const file = new File([], 'foto.png')
        const url = await fileUpload( file );

        expect( url ).toBe( null )

    })
    


})


